<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start"><ion-menu-button></ion-menu-button></ion-buttons>
    <ion-title>{{ getTitle() | translate}}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="inner-content">
        @if (inputForm) {
          <form class="input-form" [formGroup]="inputForm" novalidate>
            <ion-row>
              <ion-col size="12" size-sm="12" size-md="12" size-lg="6">
                @if (mode === editDictationPageMode.Edit) {
                  <app-section-card headerTitle="Info" icon="info-circle">
                    <div class="title">
                      <ion-item>
                        <ion-input type="text" formControlName="title"
                          label="{{'Title'|translate}} *"
                        placeholder="{{ 'example' | translate }}: Dictation {{now | date:'yyyy-MM-dd'}}"></ion-input>
                      </ion-item>
                      @if (title.invalid && (title.dirty || title.touched)) {
                        <div class="error-text">
                          @if (title.errors.required) {
                            <div>{{'Title is required'|translate}}</div>
                          }
                          @if (title.errors.minlength) {
                            <div>{{'Title must be at least 5 characters long'|translate}}</div>
                          }
                          @if (title.errors.maxlength) {
                            <div>{{'Title cannot over 50 characters long'|translate}}</div>
                          }
                        </div>
                      }
                    </div>
                    <div class="description">
                      <ion-item>
                        <ion-input type="text" label="{{'Description'|translate}}" formControlName="description"></ion-input>
                      </ion-item>
                      @if (description.invalid && (description.dirty || description.touched)) {
                        <div class="error-text">
                          @if (description.errors.maxlength) {
                            <div>{{'Description cannot over 100 characters long'|translate}}</div>
                          }
                        </div>
                      }
                    </div>
                    <ion-item class="suitableAge">
                      <ion-select formControlName="suitableStudent" interface="popover"
                        label="{{'Suitable'|translate}} ({{'Age'|translate}})">
                        @for (state of suitableStudentOptions; track state) {
                          <ion-select-option
                          [value]="state">{{'SuitableStudent.' + state|translate}}</ion-select-option>
                        }
                      </ion-select>
                    </ion-item>
                  </app-section-card>
                }
                <app-section-card headerTitle="Type" icon="tags">
                  <ion-radio-group formControlName="type">
                    <ion-row class="radio">
                      <ion-col>
                        <ion-item>
                          <ion-radio value="word">
                            <span [class.deselected]="type.value === dictationType.Sentence">
                              <fa-icon [icon]="['fas', 'list-ol']"></fa-icon>{{'Single Word'|translate}}</span>
                            </ion-radio>
                          </ion-item>
                          <div class="type-example" [class.deselected]="type.value === dictationType.Sentence">
                            Example:<br/>apple<br/>bus-stop<br/>cat
                          </div>
                        </ion-col>
                        <ion-col>
                          <ion-item>
                            <ion-radio value="sentence">
                              <span [class.deselected]="type.value === dictationType.Word">
                                <fa-icon [icon]="['fas', 'align-left']"></fa-icon>{{'Sentence'|translate}}</span>
                              </ion-radio>
                            </ion-item>
                            <div class="type-example" [class.deselected]="type.value === dictationType.Word">
                              Example:<br/> I walk to school. I do not ride a bike. I do not ride the bus.
                            </div>
                          </ion-col>
                        </ion-row>
                      </ion-radio-group>
                </app-section-card>
                      <app-section-card [headerTitle]="'Options' | translate" icon="sliders-h">
                        @if (mode === pageMode.Start) {
                          <app-voice-mode-selector
                            [selectedMode]="voiceMode.value"
                            (selectedModeChange)="onVoiceModeChange($event)">
                          </app-voice-mode-selector>
                        }
                        @if (type.value === dictationType.Word) {
                          <div class="word-options-all">
                            <ion-row>
                              <ion-col>
                                <ion-item>
                                  <ion-toggle formControlName="showImage">
                                    <fa-icon [icon]="['far', 'images']"></fa-icon> {{'Show Image'|translate}}
                                  </ion-toggle>
                                </ion-item>
                              </ion-col>
                              <ion-col>
                                <ion-item>
                                  <ion-toggle class="include-ai-image-toggle" formControlName="includeAIImage" [disabled]="showImage.value !== true">
                                    <fa-icon [icon]="['fas', 'robot']"></fa-icon>{{'Include AI Image'|translate}}
                                  </ion-toggle>
                                </ion-item>
                              </ion-col>
                            </ion-row>
                            <ion-item>
                              <ion-toggle formControlName="wordContainSpace">
                                <fa-icon [icon]="['fas', 'window-minimize']" /> {{'Words Contain Space'|translate}}
                              </ion-toggle>
                            </ion-item>
                            @if (mode === pageMode.Start) {
                              <div class="word-options-instant">
                                <app-vocab-practice-type-selector
                                  [selectedType]="wordPracticeType.value || practiceType.Spell"
                                  (selectedTypeChange)="wordPracticeType.setValue($event)">
                                </app-vocab-practice-type-selector>
                              </div>
                            }
                          </div>
                        }
                        @if (type.value === dictationType.Sentence) {
                          <div>
                            <ion-item>
                              <ion-select formControlName="sentenceLength" interface="popover">
                                <div slot="label"><fa-icon [icon]="['fas', 'ruler']" /> {{'Each Sentence Length'|translate}}</div>
                                @for (state of sentenceLengthOptions; track state) {
                                  <ion-select-option [value]="state">{{'SentenceLength.' + state|translate}}</ion-select-option>
                                }
                              </ion-select>
                            </ion-item>
                            @if (mode === pageMode.Start) {
                              <app-article-dictation-options #articleDictationOptions></app-article-dictation-options>
                            }
                          </div>
                        }
                        @if (mode === pageMode.Start) {
                          <div class="options-notes">
                            <div class="options-note-row">
                              <fa-icon [icon]="['fas', 'circle-info']"></fa-icon>
                              <ion-note color="medium">{{'QuickDictation.OptionAvailabilityNote1'|translate}}</ion-note>
                            </div>
                          </div>
                        }
                      </app-section-card>
              </ion-col>
              <ion-col id="ion-col-textarea" size="12" size-sm="12" size-md="12" size-lg="6">
            <app-section-card headerTitle="Content" icon="pen">
                <!--              <ion-item>-->
                <!--                <ion-label position="floating">{{'Vocabulary'|translate}} * ({{'separate by space, comma or 1 word per line'|translate}})-->
              <!--                </ion-label>-->
              <!--                <ion-textarea formControlName="vocabulary" rows="10"></ion-textarea>-->
            <!--              </ion-item>-->
            <ion-item>
              <ion-textarea formControlName="question" rows="10" labelPlacement="floating">
                @if (type.value == dictationType.Word) {
                  <div slot="label">{{'Vocabulary'|translate}} * ({{'separate by space, comma or 1 word per line'|translate}})</div>
                }
                @if (type.value == dictationType.Sentence) {
                  <div slot="label">{{'Input an passage'|translate}} *:</div>
                }
              </ion-textarea>
            </ion-item>
            <!--              <div *ngIf="vocabulary.invalid && (vocabulary.dirty || vocabulary.touched)" class="error-text">-->
            <!--                <div *ngIf="vocabulary.errors.maxVocabulary">{{'Cannot over 50 vocabulary'|translate}}</div>-->
            <!--                <div *ngIf="vocabulary.errors.pattern">{{'Cannot contain invalid character(s)'|translate}}</div>-->
          <!--              </div>-->
          @if (question.invalid && (question.dirty || question.touched)) {
            <div class="error-text">
              @if (question.errors?.required) {
                <div>{{'Cannot find any word or sentence'|translate}}</div>
              }
            </div>
          }
          @if (inputForm.invalid && (question.touched || question.dirty)) {
            <div class="error-text">
              @if (inputForm.errors?.maxVocabulary) {
                <div>{{'Cannot over 50 vocabulary'|translate}}</div>
              }
              @if (inputForm.errors?.invalidVocabularyPattern) {
                <div>{{'Cannot contain invalid character(s)'|translate}}</div>
              }
            </div>
          }
          @if (isPreview) {
            <ion-list style="padding-top: 0px; padding-bottom: 0px;">
              @for (question of questions; track question; let i = $index) {
                <ion-item>
                  <ion-label>{{i+1}}. {{question}}</ion-label>
                </ion-item>
              }
            </ion-list>
          }
          @if (!isPreview) {
            <ion-button class="action-button" fill="outline" (click)="preview()">
              <fa-icon icon="eye"></fa-icon>&nbsp;{{'Preview'|translate}}
            </ion-button>
          }
          @if (isPreview) {
            <ion-button class="action-button" fill="outline" (click)="closePreview()" color="medium">
              <fa-icon icon="eye-slash"></fa-icon>&nbsp;{{'Preview'|translate}}
            </ion-button>
          }
          @if (mode === pageMode.Edit) {
            <ion-button class="ion-float-right action-button"
              (click)="saveDictation()" [disabled]="!inputForm.valid">
              <fa-icon icon="save"></fa-icon>&nbsp;{{'Save'|translate}}
            </ion-button>
          }
          @if (mode === pageMode.Start) {
            <ion-button class="ion-float-right action-button"
              (click)="startDictationNow()" [disabled]="!inputForm.valid">
              <fa-icon [icon]="['fas', 'play']"></fa-icon>&nbsp;{{'Start'|translate}}
            </ion-button>
          }
          </app-section-card>
        </ion-col>
      </ion-row>
    </form>
  }

</div>

<app-footer></app-footer>
</ion-content>
